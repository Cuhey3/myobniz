const MongoClient = require('mongodb').MongoClient;
const { getDateType } = require('./appUtil.js');
const assert = require('assert');
const url = process.env.MONGODB_URI;
const dbName = process.env.MONGODB_URI.split('/').pop();
let timeRequiredData = [];

function getOrInsertTimeRequiredData(record = null, callback = function() {}) {
  const client = new MongoClient(url);
  client.connect(function(err) {
    assert.equal(null, err);
    const db = client.db(dbName);
    const collection = db.collection('timeRequired');
    if (record) {
      collection.insertOne(record, function(err, result) {
        assert.equal(err, null);
        collection.find({}).toArray(function(err, docs) {
          assert.equal(err, null);
          timeRequiredData = docs;
          client.close();
          callback();
        });
      });
    }
    else {
      collection.find({}).toArray(function(err, docs) {
        assert.equal(err, null);
        timeRequiredData = docs;
        client.close();
        callback();
      });
    }
  });
}
getOrInsertTimeRequiredData();

function secondToMinuteSecondExpression(second) {
  if (second) {
    return Math.floor(second / 60) + "m" + (("00" + Math.floor(second % 60)).substr(-2)) + "s";
  }
  else {
    return 'None';
  }
}

TimeTable.secondToMinuteSecondExpression = secondToMinuteSecondExpression;

const nameToDepartures = {
  "シャトル/錦糸町/帰り": {
    from: "錦糸町",
    to: ["葛西"],
    line: "シャトル",
    departures: {
      weekday: [
        1830, 1920, 2000, 2050, 2150
      ]
    }
  },
  "都バス/錦糸町/帰り": {
    from: "錦糸町",
    to: ["船堀", "葛西"],
    line: "都バス",
    departures: {
      weekday: [
        1800, 1806, 1812, 1819, 1826, 1833, 1840, 1848, 1856,
        1904, 1912, 1920, 1928, 1936, 1944, 1952,
        2000, 2008, 2018, 2028, 2038, 2048, 2059
      ]
    }
  },
  "シャトル/葛西/行き": {
    from: "葛西",
    to: ["錦糸町"],
    line: "シャトル",
    departures: {
      weekday: [
        0904, 0944, 1954
      ]
    }
  },
  "都バス/葛西/行き": {
    from: "葛西",
    to: ["船堀", "錦糸町"],
    line: "都バス",
    departures: {
      weekday: [
        0805, 0811, 0817, 0823, 0829, 0835, 0841, 0848, 0855,
        0903, 0911, 0919, 0927, 0935, 0943, 0948, 0951, 0959
      ]
    }
  },
  "東西線/葛西/行き": {
    from: "葛西",
    to: ["門前仲町", "茅場町", "日本橋", "大手町", "九段下", "飯田橋"],
    line: "東西線",
    departures: {
      weekday: [
        0514, 0528, 0537, 0549, 0556, 0609, 0618, 0621, 0625, 0629, 0632, 0635, 0638, 0641, 0643, 0646, 0649, 0651, 0655, 0657, 0700, 0703, 0705, 0707, 0710, 0712, 0716, 0718, 0721, 0724, 0726, 0728, 0731, 0733, 0736, 0738, 0741, 0743, 0745, 0748, 0750, 0752, 0755, 0757, 0759, 0802, 0804, 0806, 0809, 0811, 0813, 0816, 0818, 0820, 0823, 0825, 0827, 0830, 0832, 0834, 0837, 0839, 0842, 0844, 0846, 0849, 0851, 0854, 0856, 0859, 0901, 0904, 0906, 0909, 0912, 0915, 0919, 0927, 0931, 0934, 0940, 0944, 0951, 0955, 1000, 1007, 1012, 1021, 1026, 1035, 1041, 1050, 1056, 1105, 1111, 1120, 1126, 1135, 1141, 1150, 1156, 1205, 1211, 1220, 1226, 1235, 1241, 1250, 1256, 1305, 1311, 1320, 1326, 1335, 1341, 1350, 1356, 1405, 1411, 1420, 1426, 1435, 1441, 1450, 1456, 1505, 1511, 1520, 1526, 1535, 1541, 1549, 1555, 1603, 1609, 1613, 1621, 1627, 1635, 1639, 1647, 1655, 1702, 1708, 1711, 1718, 1722, 1731, 1734, 1737, 1744, 1748, 1751, 1757, 1803, 1810, 1817, 1824, 1828, 1832, 1840, 1844, 1851, 1854, 1858, 1906, 1909, 1917, 1921, 1928, 1933, 1941, 1944, 1948, 1955, 1958, 2006, 2009, 2012, 2020, 2024, 2032, 2035, 2043, 2046, 2050, 2057, 2101, 2105, 2113, 2116, 2121, 2127, 2131, 2135, 2143, 2147, 2152, 2201, 2206, 2211, 2220, 2226, 2231, 2239, 2244, 2247, 2253, 2257, 2303, 2309, 2313, 2321, 2332, 2342, 2354, 2408, 2418, 2424, 2431
      ],
      holiday: [
        0514, 0526, 0539, 0551, 0600, 0610, 0617, 0625, 0635, 0643, 0648, 0654, 0701, 0707, 0712, 0718, 0724, 0728, 0733, 0736, 0742, 0746, 0751, 0755, 0800, 0808, 0812, 0816, 0820, 0827, 0830, 0834, 0838, 0847, 0851, 0856, 0904, 0909, 0912, 0920, 0927, 0935, 0941, 0950, 0956, 1005, 1011, 1020, 1026, 1035, 1041, 1050, 1056, 1105, 1111, 1120, 1126, 1135, 1141, 1150, 1156, 1205, 1211, 1220, 1226, 1235, 1241, 1250, 1256, 1305, 1311, 1320, 1326, 1335, 1341, 1350, 1356, 1405, 1411, 1420, 1426, 1435, 1441, 1450, 1456, 1505, 1511, 1520, 1526, 1535, 1541, 1550, 1556, 1605, 1611, 1620, 1626, 1635, 1641, 1650, 1656, 1705, 1711, 1720, 1726, 1735, 1741, 1750, 1756, 1805, 1811, 1820, 1826, 1835, 1841, 1851, 1858, 1908, 1914, 1924, 1930, 1937, 1947, 1954, 2000, 2009, 2016, 2023, 2029, 2039, 2045, 2052, 2059, 2110, 2117, 2126, 2134, 2141, 2148, 2156, 2203, 2211, 2218, 2226, 2234, 2242, 2250, 2259, 2309, 2320, 2331, 2342, 2354, 2405, 2416, 2428
      ]
    }
  },
  "三田線/大手町/行き": {
    from: "大手町",
    to: ["白金高輪"],
    line: "三田線",
    departures: {
      weekday: [
        0518, 0532, 0545, 0556, 0607, 0616, 0622, 0628, 0635, 0642, 0649, 0656, 0701, 0707, 0710, 0716, 0721, 0725, 0730, 0735, 0739, 0742, 0745, 0750, 0753, 0756, 0759, 0802, 0805, 0808, 0811, 0814, 0817, 0820, 0824, 0827, 0830, 0833, 0836, 0839, 0842, 0845, 0848, 0852, 0855, 0900, 0904, 0908, 0911, 0916, 0920, 0926, 0931, 0936, 0938, 0943, 0948, 0952, 0958, 1004, 1010, 1016, 1022, 1027, 1034, 1040, 1046, 1052, 1058, 1104, 1110, 1116, 1122, 1128, 1134, 1140, 1146, 1152, 1158, 1205, 1211, 1217, 1223, 1229, 1235, 1241, 1247, 1253, 1259, 1305, 1311, 1317, 1323, 1329, 1335, 1341, 1347, 1353, 1359, 1405, 1411, 1417, 1423, 1429, 1435, 1441, 1447, 1453, 1459, 1505, 1511, 1517, 1523, 1529, 1535, 1541, 1547, 1553, 1559, 1605, 1611, 1617, 1623, 1629, 1635, 1641, 1647, 1653, 1659, 1705, 1711, 1716, 1721, 1727, 1732, 1737, 1742, 1746, 1751, 1756, 1802, 1807, 1812, 1817, 1822, 1827, 1832, 1837, 1842, 1846, 1852, 1856, 1902, 1907, 1912, 1918, 1923, 1928, 1933, 1939, 1945, 1951, 1957, 2003, 2009, 2015, 2021, 2026, 2032, 2039, 2045, 2052, 2058, 2104, 2109, 2116, 2122, 2128, 2133, 2141, 2148, 2156, 2202, 2210, 2216, 2223, 2230, 2238, 2247, 2255, 2303, 2312, 2321, 2331, 2342, 2356, 2411, 2424
      ]
    }
  },
  "南北線/白金高輪/行き": {
    from: "白金高輪",
    to: ["目黒"],
    line: "南北線",
    departures: {
      weekday: [
        0510, 0521, 0536, 0543, 0551, 0600, 0609, 0619, 0622, 0630, 0635, 0643, 0647, 0650, 0656, 0700, 0703, 0708, 0710, 0713, 0716, 0719, 0722, 0725, 0728, 0731, 0733, 0737, 0739, 0743, 0746, 0749, 0752, 0755, 0758, 0801, 0803, 0806, 0809, 0812, 0814, 0817, 0819, 0822, 0825, 0827, 0830, 0832, 0835, 0837, 0840, 0843, 0845, 0848, 0850, 0853, 0856, 0859, 0901, 0905, 0908, 0911, 0914, 0917, 0919, 0922, 0927, 0929, 0932, 0936, 0939, 0944, 0948, 0953, 1000, 1004, 1009, 1016, 1021, 1024, 1029, 1034, 1039, 1046, 1051, 1054, 1059, 1105, 1109, 1114, 1120, 1124, 1129, 1135, 1139, 1144, 1151, 1154, 1159, 1205, 1209, 1214, 1221, 1224, 1230, 1236, 1239, 1245, 1251, 1254, 1300, 1306, 1309, 1315, 1321, 1324, 1330, 1336, 1339, 1345, 1351, 1354, 1400, 1406, 1409, 1415, 1421, 1424, 1430, 1436, 1439, 1445, 1451, 1454, 1500, 1506, 1509, 1515, 1521, 1524, 1530, 1536, 1539, 1545, 1551, 1554, 1600, 1606, 1609, 1615, 1621, 1624, 1630, 1636, 1639, 1645, 1651, 1654, 1700, 1706, 1709, 1713, 1719, 1723, 1727, 1731, 1737, 1740, 1744, 1748, 1752, 1756, 1801, 1804, 1809, 1813, 1816, 1820, 1824, 1828, 1832, 1835, 1840, 1844, 1849, 1853, 1857, 1900, 1904, 1908, 1913, 1916, 1920, 1924, 1929, 1932, 1936, 1941, 1945, 1949, 1954, 2000, 2004, 2009, 2013, 2018, 2023, 2027, 2031, 2035, 2040, 2045, 2051, 2056, 2101, 2106, 2111, 2116, 2121, 2127, 2131, 2137, 2142, 2146, 2150, 2156, 2202, 2208, 2215, 2218, 2224, 2230, 2237, 2243, 2249, 2251, 2256, 2303, 2310, 2317, 2325, 2329, 2334, 2344, 2354, 2400, 2409, 2416, 2424, 2437
      ]
    }
  },
  "南北線/飯田橋/行き": {
    from: "飯田橋",
    to: ["永田町"],
    line: "南北線",
    departures: {
      holiday: [
        0515, 0530, 0542, 0553, 0603, 0613, 0623, 0633, 0643, 0653, 0702, 0713, 0722, 0729, 0736, 0742, 0748, 0754, 0800, 0806, 0812, 0817, 0823, 0828, 0833, 0838, 0843, 0848, 0853, 0858, 0903, 0908, 0913, 0918, 0923, 0927, 0931, 0936, 0941, 0947, 0953, 0959, 1005, 1011, 1017, 1023, 1029, 1035, 1041, 1047, 1053, 1059, 1105, 1111, 1117, 1123, 1129, 1135, 1141, 1147, 1153, 1159, 1205, 1211, 1217, 1223, 1229, 1235, 1241, 1247, 1253, 1259, 1305, 1311, 1317, 1323, 1329, 1335, 1341, 1347, 1353, 1359, 1405, 1411, 1417, 1423, 1429, 1435, 1441, 1447, 1453, 1459, 1505, 1511, 1517, 1523, 1529, 1535, 1541, 1547, 1553, 1559, 1605, 1611, 1617, 1623, 1629, 1635, 1641, 1647, 1653, 1659, 1705, 1711, 1717, 1723, 1729, 1735, 1741, 1747, 1753, 1759, 1805, 1811, 1817, 1823, 1829, 1835, 1841, 1847, 1853, 1859, 1905, 1911, 1917, 1924, 1931, 1938, 1944, 1951, 1957, 2004, 2011, 2018, 2026, 2033, 2040, 2047, 2055, 2102, 2111, 2119, 2126, 2133, 2141, 2148, 2155, 2203, 2211, 2218, 2227, 2234, 2241, 2249, 2256, 2303, 2312, 2321, 2330, 2339, 2346, 2354, 2403, 2415
      ]
    }
  },
  "南北線/白金高輪/帰り": {
    from: "白金高輪",
    to: ["飯田橋"],
    line: "南北線",
    departures: {
      weekday: [
        0500, 0507, 0517, 0522, 0531, 0534, 0544, 0545, 0555, 0557, 0607, 0608, 0616, 0618, 0627, 0627, 0634, 0637, 0644, 0647, 0654, 0657, 0702, 0704, 0710, 0714, 0718, 0723, 0724, 0728, 0730, 0734, 0736, 0739, 0741, 0744, 0747, 0750, 0752, 0756, 0757, 0800, 0801, 0804, 0805, 0807, 0808, 0812, 0814, 0816, 0817, 0820, 0821, 0824, 0824, 0826, 0827, 0829, 0832, 0832, 0834, 0835, 0837, 0839, 0840, 0842, 0844, 0845, 0847, 0849, 0851, 0852, 0855, 0855, 0858, 0858, 0902, 0903, 0906, 0909, 0909, 0912, 0913, 0916, 0919, 0919, 0923, 0925, 0928, 0930, 0932, 0934, 0935, 0939, 0941, 0943, 0947, 0947, 0951, 0954, 0955, 0959, 0959, 1003, 1005, 1007, 1011, 1011, 1015, 1016, 1019, 1021, 1025, 1027, 1031, 1033, 1036, 1039, 1042, 1045, 1047, 1051, 1053, 1057, 1059, 1103, 1105, 1109, 1111, 1115, 1117, 1121, 1123, 1127, 1129, 1133, 1135, 1139, 1141, 1145, 1147, 1151, 1153, 1157, 1159, 1203, 1205, 1209, 1211, 1215, 1217, 1221, 1223, 1227, 1229, 1233, 1235, 1239, 1241, 1245, 1247, 1251, 1253, 1257, 1259, 1303, 1305, 1309, 1311, 1315, 1317, 1321, 1323, 1327, 1329, 1333, 1335, 1339, 1341, 1345, 1347, 1351, 1353, 1357, 1359, 1403, 1405, 1409, 1411, 1415, 1417, 1421, 1423, 1427, 1429, 1433, 1435, 1439, 1441, 1445, 1447, 1451, 1453, 1457, 1459, 1503, 1505, 1509, 1511, 1515, 1517, 1521, 1523, 1527, 1529, 1533, 1535, 1539, 1541, 1545, 1547, 1551, 1553, 1557, 1559, 1603, 1605, 1609, 1611, 1615, 1617, 1621, 1623, 1627, 1629, 1633, 1636, 1639, 1642, 1645, 1649, 1651, 1655, 1658, 1701, 1704, 1707, 1710, 1713, 1716, 1719, 1722, 1725, 1727, 1731, 1733, 1736, 1738, 1741, 1744, 1746, 1749, 1751, 1755, 1756, 1759, 1801, 1804, 1806, 1809, 1811, 1814, 1816, 1819, 1821, 1824, 1826, 1829, 1831, 1834, 1836, 1839, 1841, 1844, 1846, 1849, 1851, 1855, 1856, 1900, 1901, 1904, 1906, 1909, 1912, 1915, 1917, 1920, 1922, 1925, 1927, 1930, 1933, 1935, 1938, 1940, 1943, 1946, 1948, 1952, 1953, 1959, 1959, 2004, 2005, 2010, 2011, 2015, 2018, 2021, 2023, 2027, 2029, 2033, 2035, 2039, 2042, 2046, 2049, 2054, 2056, 2100, 2101, 2106, 2108, 2114, 2115, 2121, 2123, 2127, 2129, 2134, 2135, 2141, 2142, 2148, 2149, 2154, 2156, 2200, 2203, 2208, 2209, 2214, 2216, 2221, 2224, 2228, 2230, 2235, 2237, 2243, 2244, 2251, 2251, 2258, 2259, 2306, 2307, 2314, 2315, 2322, 2322, 2329, 2331, 2336, 2338, 2344, 2345, 2352, 2353, 2400, 2400, 2406, 2407
      ]
    }
  },
  "南北線/目黒/帰り": {
    from: "目黒",
    to: ["飯田橋"],
    line: "南北線",
    departures: {
      weekday: [
        0512, 0525, 0538, 0547, 0552, 0600, 0603, 0609, 0619, 0629, 0639, 0648, 0651, 0655, 0659, 0704, 0709, 0713, 0716, 0720, 0722, 0725, 0728, 0731, 0733, 0736, 0738, 0742, 0745, 0748, 0751, 0753, 0756, 0759, 0801, 0803, 0806, 0808, 0811, 0813, 0816, 0819, 0822, 0824, 0827, 0829, 0832, 0834, 0837, 0839, 0842, 0844, 0847, 0850, 0853, 0858, 0901, 0904, 0908, 0910, 0913, 0917, 0920, 0923, 0928, 0930, 0934, 0938, 0941, 0945, 0949, 0953, 0957, 1004, 1009, 1012, 1018, 1022, 1027, 1032, 1037, 1040, 1047, 1052, 1055, 1101, 1107, 1110, 1116, 1122, 1125, 1131, 1137, 1140, 1146, 1152, 1155, 1201, 1207, 1210, 1216, 1222, 1225, 1231, 1237, 1240, 1246, 1252, 1255, 1301, 1307, 1310, 1316, 1322, 1325, 1331, 1337, 1340, 1346, 1352, 1355, 1401, 1407, 1410, 1416, 1422, 1425, 1431, 1437, 1440, 1446, 1452, 1455, 1501, 1507, 1510, 1516, 1522, 1525, 1531, 1537, 1540, 1546, 1552, 1555, 1601, 1607, 1610, 1616, 1622, 1625, 1631, 1637, 1640, 1646, 1653, 1656, 1702, 1709, 1711, 1716, 1720, 1724, 1727, 1731, 1733, 1738, 1741, 1744, 1749, 1754, 1759, 1803, 1806, 1809, 1814, 1819, 1823, 1828, 1831, 1834, 1839, 1843, 1848, 1851, 1855, 1858, 1903, 1906, 1910, 1915, 1919, 1924, 1928, 1930, 1935, 1940, 1943, 1947, 1953, 1958, 2003, 2008, 2012, 2016, 2021, 2027, 2030, 2035, 2041, 2048, 2051, 2059, 2103, 2109, 2114, 2118, 2122, 2129, 2134, 2137, 2143, 2149, 2154, 2158, 2203, 2208, 2215, 2219, 2223, 2228, 2232, 2238, 2245, 2253, 2300, 2302, 2309, 2317, 2324, 2333, 2337, 2340, 2347, 2354, 2402
      ]
    }
  },
  "東西線/飯田橋/帰り": {
    from: "飯田橋",
    to: ["葛西", "門前仲町", "茅場町", "日本橋", "大手町", "九段下"],
    line: "東西線",
    departures: {
      weekday: [
        0514, 0527, 0537, 0547, 0557, 0608, 0613, 0626, 0633, 0647, 0653, 0703, 0707, 0714, 0718, 0721, 0726, 0729, 0732, 0738, 0741, 0747, 0750, 0755, 0758, 0804, 0806, 0812, 0814, 0817, 0822, 0824, 0827, 0832, 0834, 0837, 0842, 0844, 0847, 0852, 0854, 0857, 0902, 0904, 0907, 0912, 0915, 0918, 0921, 0928, 0931, 0937, 0940, 0942, 0946, 0949, 0952, 0954, 0959, 1001, 1004, 1011, 1013, 1016, 1020, 1023, 1026, 1029, 1035, 1039, 1042, 1051, 1056, 1104, 1108, 1118, 1123, 1133, 1138, 1148, 1153, 1203, 1208, 1218, 1223, 1233, 1238, 1248, 1253, 1303, 1308, 1318, 1323, 1333, 1338, 1348, 1353, 1403, 1408, 1418, 1423, 1433, 1438, 1448, 1453, 1503, 1508, 1518, 1523, 1533, 1538, 1548, 1553, 1603, 1608, 1618, 1623, 1634, 1639, 1643, 1651, 1655, 1658, 1705, 1709, 1713, 1720, 1724, 1731, 1734, 1740, 1744, 1750, 1755, 1800, 1803, 1805, 1810, 1813, 1819, 1823, 1828, 1832, 1840, 1843, 1849, 1852, 1858, 1904, 1908, 1911, 1918, 1921, 1926, 1929, 1932, 1939, 1944, 1951, 1954, 1957, 2005, 2009, 2013, 2020, 2024, 2030, 2034, 2041, 2045, 2054, 2058, 2106, 2111, 2120, 2124, 2131, 2135, 2143, 2146, 2155, 2158, 2206, 2210, 2219, 2223, 2231, 2235, 2239, 2248, 2253, 2258, 2308, 2313, 2318, 2327, 2332, 2335, 2340, 2348, 2352, 2355, 2400, 2405, 2410, 2415
      ],
      holiday: [
        0514, 0527, 0538, 0547, 0557, 0608, 0614, 0620, 0629, 0636, 0645, 0653, 0702, 0708, 0715, 0722, 0728, 0735, 0741, 0746, 0753, 0759, 0805, 0811, 0817, 0823, 0826, 0830, 0835, 0840, 0845, 0849, 0858, 0902, 0907, 0915, 0920, 0924, 0934, 0938, 0948, 0953, 1004, 1008, 1018, 1023, 1033, 1038, 1048, 1053, 1103, 1108, 1118, 1123, 1133, 1138, 1148, 1153, 1203, 1208, 1218, 1223, 1233, 1238, 1248, 1253, 1303, 1308, 1318, 1323, 1333, 1338, 1348, 1353, 1403, 1408, 1418, 1423, 1433, 1438, 1448, 1453, 1503, 1508, 1518, 1523, 1533, 1538, 1548, 1553, 1603, 1608, 1618, 1624, 1634, 1639, 1649, 1654, 1704, 1709, 1719, 1724, 1734, 1739, 1749, 1754, 1804, 1809, 1819, 1824, 1834, 1839, 1849, 1854, 1904, 1909, 1919, 1924, 1929, 1939, 1945, 1950, 2001, 2007, 2012, 2023, 2029, 2035, 2041, 2052, 2058, 2104, 2110, 2121, 2127, 2133, 2140, 2151, 2157, 2204, 2211, 2218, 2226, 2233, 2241, 2249, 2257, 2304, 2312, 2319, 2326, 2334, 2342, 2350, 2356, 2405, 2416
      ]
    }
  },
  "東西線/茅場町/帰り": {
    from: "茅場町",
    to: ["葛西", "門前仲町"],
    line: "東西線",
    departures: {
      holiday: [
        0523, 0536, 0547, 0556, 0606, 0617, 0623, 0629, 0638, 0645, 0654, 0702, 0711, 0718, 0724, 0731, 0737, 0744, 0750, 0756, 0802, 0808, 0814, 0820, 0826, 0832, 0835, 0839, 0844, 0849, 0854, 0858, 0907, 0911, 0916, 0924, 0929, 0933, 0943, 0947, 0957, 1003, 1013, 1017, 1027, 1032, 1042, 1047, 1057, 1102, 1112, 1117, 1127, 1132, 1142, 1147, 1157, 1202, 1212, 1217, 1227, 1232, 1242, 1247, 1257, 1302, 1312, 1317, 1327, 1332, 1342, 1347, 1357, 1402, 1412, 1417, 1427, 1432, 1442, 1447, 1457, 1502, 1512, 1517, 1527, 1532, 1542, 1547, 1557, 1602, 1612, 1617, 1627, 1633, 1643, 1648, 1658, 1703, 1713, 1718, 1728, 1733, 1743, 1748, 1758, 1803, 1813, 1818, 1828, 1833, 1843, 1848, 1858, 1903, 1913, 1918, 1928, 1933, 1938, 1948, 1954, 1959, 2010, 2016, 2021, 2032, 2038, 2044, 2050, 2101, 2107, 2113, 2119, 2130, 2136, 2142, 2149, 2200, 2206, 2213, 2220, 2227, 2235, 2242, 2250, 2258, 2306, 2313, 2321, 2328, 2335, 2343, 2351, 2359, 2405, 2414, 2425
      ]
    }
  },
  "大江戸線/門前仲町/行き": {
    from: "門前仲町",
    to: ["清澄白河"],
    line: "大江戸線",
    departures: {
      weekday: [
        0529, 0551, 0605, 0616, 0628, 0644, 0654, 0702, 0710, 0718, 0725, 0731, 0737, 0743, 0749, 0755, 0800, 0805, 0810, 0815, 0819, 0823, 0827, 0831, 0834, 0837, 0840, 0843, 0846, 0849, 0852, 0855, 0858, 0901, 0904, 0907, 0910, 0913, 0916, 0919, 0922, 0925, 0929, 0932, 0936, 0939, 0943, 0947, 0951, 0955, 1000, 1005, 1010, 1015, 1018, 1021, 1025, 1031, 1036, 1041, 1046, 1052, 1058, 1104, 1110, 1116, 1122, 1128, 1134, 1140, 1146, 1152, 1158, 1204, 1210, 1216, 1222, 1228, 1234, 1240, 1246, 1252, 1258, 1304, 1310, 1316, 1322, 1328, 1334, 1340, 1346, 1352, 1358, 1404, 1410, 1416, 1422, 1428, 1434, 1440, 1446, 1452, 1458, 1504, 1510, 1516, 1522, 1528, 1534, 1540, 1546, 1552, 1558, 1604, 1610, 1616, 1622, 1628, 1634, 1640, 1646, 1652, 1658, 1703, 1708, 1713, 1718, 1723, 1728, 1733, 1738, 1743, 1748, 1753, 1758, 1803, 1808, 1813, 1818, 1823, 1828, 1833, 1838, 1843, 1848, 1853, 1859, 1905, 1911, 1917, 1923, 1929, 1935, 1941, 1947, 1953, 1959, 2004, 2010, 2015, 2021, 2025, 2030, 2036, 2043, 2048, 2054, 2058, 2103, 2109, 2116, 2121, 2127, 2131, 2136, 2142, 2148, 2154, 2200, 2208, 2215, 2221, 2228, 2233, 2241, 2249, 2257, 2306, 2313, 2321, 2329, 2337, 2346, 2355, 2405, 2413, 2422, 2437, 24535
      ]
    }
  },
  "半蔵門線/清澄白河/行き": {
    from: "清澄白河",
    to: ["錦糸町"],
    line: "半蔵門線",
    departures: {
      weekday: [
        0506, 0523, 0539, 0553, 0608, 0619, 0625, 0632, 0640, 0645, 0651, 0655, 0701, 0706, 0710, 0714, 0717, 0724, 0728, 0734, 0737, 0742, 0744, 0747, 0753, 0756, 0801, 0804, 0807, 0809, 0814, 0816, 0818, 0823, 0825, 0830, 0832, 0835, 0839, 0842, 0846, 0848, 0850, 0853, 0857, 0900, 0903, 0907, 0909, 0911, 0916, 0918, 0920, 0923, 0925, 0928, 0931, 0933, 0936, 0938, 0941, 0944, 0946, 0949, 0952, 0955, 0958, 1001, 1003, 1006, 1009, 1012, 1015, 1018, 1022, 1025, 1028, 1030, 1037, 1042, 1047, 1051, 1055, 1100, 1105, 1109, 1114, 1117, 1122, 1127, 1132, 1137, 1142, 1147, 1152, 1157, 1202, 1207, 1212, 1217, 1222, 1227, 1232, 1237, 1242, 1247, 1252, 1257, 1302, 1307, 1312, 1317, 1322, 1327, 1332, 1337, 1342, 1347, 1352, 1357, 1402, 1407, 1412, 1417, 1422, 1427, 1432, 1437, 1442, 1447, 1452, 1457, 1502, 1507, 1512, 1517, 1522, 1527, 1532, 1537, 1542, 1547, 1552, 1557, 1602, 1607, 1612, 1617, 1622, 1627, 1632, 1636, 1639, 1643, 1646, 1650, 1656, 1701, 1705, 1708, 1712, 1715, 1718, 1722, 1726, 1729, 1733, 1736, 1739, 1743, 1746, 1749, 1752, 1756, 1800, 1803, 1806, 1809, 1812, 1815, 1818, 1821, 1824, 1827, 1830, 1833, 1836, 1839, 1842, 1846, 1849, 1852, 1855, 1858, 1902, 1906, 1909, 1912, 1916, 1919, 1922, 1926, 1929, 1932, 1935, 1938, 1942, 1946, 1949, 1952, 1955, 1958, 2002, 2006, 2009, 2012, 2016, 2019, 2023, 2026, 2030, 2033, 2037, 2040, 2044, 2048, 2052, 2055, 2059, 2102, 2106, 2109, 2113, 2116, 2120, 2123, 2127, 2130, 2134, 2138, 2141, 2145, 2149, 2152, 2156, 2159, 2203, 2206, 2210, 2213, 2217, 2222, 2227, 2232, 2237, 2242, 2247, 2252, 2257, 2302, 2306, 2316, 2321, 2326, 2330, 2335, 2341, 2344, 2353, 2404, 2413, 2424, 2431
      ]
    }
  },
  "総武線/錦糸町/帰り": {
    from: "錦糸町",
    to: ["飯田橋"],
    line: "総武線",
    departures: {
      weekday: [
        0454, 0514, 0529, 0549, 0602, 0612, 0621, 0628, 0636, 0642, 0648, 0653, 0657, 0701, 0704, 0710, 0713, 0717, 0720, 0723, 0726, 0728, 0731, 0734, 0736, 0738, 0741, 0743, 0746, 0748, 0751, 0753, 0756, 0758, 0800, 0803, 0805, 0808, 0810, 0812, 0815, 0817, 0819, 0822, 0825, 0827, 0829, 0832, 0834, 0837, 0839, 0842, 0845, 0849, 0852, 0856, 0859, 0903, 0906, 0910, 0914, 0918, 0922, 0926, 0930, 0934, 0938, 0943, 0947, 0952, 0957, 1003, 1008, 1013, 1018, 1023, 1029, 1035, 1040, 1046, 1051, 1057, 1103, 1108, 1113, 1119, 1124, 1130, 1135, 1141, 1146, 1152, 1157, 1203, 1208, 1214, 1219, 1225, 1230, 1236, 1241, 1247, 1252, 1258, 1304, 1309, 1314, 1320, 1325, 1331, 1336, 1342, 1347, 1353, 1358, 1404, 1409, 1415, 1420, 1426, 1431, 1437, 1442, 1447, 1453, 1459, 1505, 1510, 1515, 1521, 1526, 1532, 1537, 1543, 1548, 1554, 1559, 1604, 1608, 1613, 1617, 1620, 1624, 1628, 1633, 1637, 1642, 1647, 1652, 1656, 1700, 1705, 1708, 1712, 1716, 1721, 1726, 1730, 1735, 1739, 1743, 1747, 1751, 1755, 1759, 1803, 1807, 1810, 1814, 1818, 1822, 1826, 1830, 1835, 1839, 1844, 1848, 1852, 1856, 1900, 1905, 1909, 1913, 1917, 1921, 1925, 1929, 1933, 1938, 1943, 1947, 1951, 1955, 1959, 2003, 2007, 2011, 2016, 2021, 2027, 2031, 2036, 2040, 2044, 2048, 2052, 2056, 2101, 2105, 2110, 2114, 2118, 2123, 2127, 2132, 2137, 2144, 2150, 2157, 2204, 2211, 2218, 2224, 2230, 2236, 2243, 2249, 2256, 2303, 2310, 2317, 2324, 2331, 2338, 2345, 2350, 2358, 2404, 2412, 2422, 2432
      ]
    }
  },
  "総武線/秋葉原/帰り": {
    from: "秋葉原",
    to: ["飯田橋"],
    line: "総武線",
    departures: {
      holiday: [
        0431, 0455, 0520, 0538, 0551, 0602, 0615, 0624, 0633, 0643, 0653, 0659, 0706, 0711, 0717, 0723, 0727, 0732, 0735, 0742, 0747, 0752, 0756, 0759, 0803, 0805, 0809, 0813, 0816, 0818, 0824, 0828, 0833, 0838, 0843, 0848, 0853, 0858, 0903, 0907, 0911, 0916, 0919, 0922, 0925, 0929, 0933, 0937, 0942, 0947, 0952, 0957, 1002, 1007, 1012, 1017, 1022, 1027, 1032, 1037, 1042, 1047, 1052, 1057, 1102, 1107, 1112, 1117, 1122, 1126, 1132, 1137, 1142, 1147, 1152, 1157, 1202, 1207, 1212, 1217, 1222, 1227, 1232, 1237, 1242, 1247, 1252, 1257, 1302, 1307, 1312, 1316, 1323, 1327, 1332, 1337, 1342, 1347, 1352, 1357, 1402, 1407, 1412, 1417, 1422, 1427, 1432, 1437, 1442, 1447, 1452, 1457, 1502, 1507, 1512, 1517, 1522, 1527, 1532, 1537, 1542, 1547, 1552, 1556, 1601, 1606, 1611, 1615, 1619, 1622, 1627, 1631, 1636, 1642, 1647, 1652, 1656, 1701, 1706, 1711, 1716, 1721, 1726, 1732, 1738, 1742, 1747, 1752, 1757, 1801, 1807, 1812, 1817, 1822, 1828, 1833, 1837, 1842, 1847, 1851, 1858, 1902, 1907, 1912, 1917, 1922, 1927, 1932, 1937, 1942, 1948, 1954, 2000, 2006, 2012, 2017, 2024, 2031, 2037, 2043, 2049, 2055, 2101, 2107, 2113, 2118, 2124, 2129, 2135, 2140, 2145, 2150, 2155, 2200, 2204, 2210, 2216, 2221, 2230, 2238, 2246, 2253, 2301, 2308, 2316, 2325, 2333, 2342, 2351, 2401, 2413, 2421, 2432, 2446, 2627, 2639, 2653, 2711
      ]
    }
  },
  "日比谷線/秋葉原/帰り": {
    from: "秋葉原",
    to: ["茅場町"],
    line: "日比谷線",
    departures: {
      holiday: [
        0512, 0524, 0535, 0546, 0556, 0605, 0613, 0620, 0626, 0632, 0637, 0642, 0648, 0653, 0658, 0703, 0708, 0713, 0718, 0723, 0728, 0733, 0738, 0743, 0748, 0753, 0758, 0803, 0808, 0813, 0818, 0823, 0828, 0833, 0838, 0843, 0848, 0853, 0858, 0903, 0908, 0913, 0918, 0923, 0928, 0933, 0938, 0943, 0948, 0953, 0958, 1003, 1008, 1013, 1018, 1023, 1028, 1033, 1038, 1043, 1048, 1053, 1058, 1103, 1108, 1113, 1118, 1123, 1128, 1133, 1138, 1143, 1148, 1153, 1158, 1203, 1208, 1213, 1218, 1223, 1228, 1233, 1238, 1243, 1248, 1253, 1258, 1303, 1308, 1313, 1318, 1323, 1328, 1333, 1338, 1343, 1348, 1353, 1358, 1403, 1408, 1413, 1418, 1423, 1428, 1433, 1438, 1443, 1448, 1453, 1458, 1503, 1508, 1513, 1518, 1523, 1528, 1533, 1538, 1543, 1548, 1553, 1558, 1603, 1608, 1613, 1618, 1623, 1628, 1633, 1638, 1643, 1648, 1653, 1658, 1703, 1708, 1713, 1718, 1723, 1728, 1733, 1738, 1743, 1748, 1753, 1758, 1803, 1808, 1813, 1818, 1823, 1828, 1833, 1838, 1843, 1848, 1853, 1858, 1903, 1908, 1913, 1918, 1923, 1928, 1933, 1938, 1944, 1950, 1956, 2002, 2008, 2014, 2020, 2026, 2032, 2038, 2044, 2050, 2056, 2102, 2108, 2114, 2120, 2126, 2132, 2138, 2144, 2150, 2156, 2202, 2208, 2215, 2221, 2229, 2237, 2245, 2253, 2302, 2311, 2320, 2330, 2339, 2352, 2404
      ]
    }
  },
  "大江戸線/清澄白河/帰り": {
    from: "清澄白河",
    to: ["門前仲町"],
    line: "大江戸線",
    departures: {
      weekday: [
        0510, 0524, 0536, 0551, 0558, 0604, 0611, 0617, 0625, 0631, 0635, 0640, 0642, 0647, 0651, 0656, 0700, 0704, 0708, 0711, 0714, 0717, 0720, 0723, 0726, 0729, 0732, 0736, 0739, 0743, 0747, 0751, 0755, 0759, 0803, 0807, 0811, 0815, 0819, 0823, 0826, 0831, 0835, 0839, 0842, 0847, 0852, 0857, 0902, 0907, 0912, 0917, 0922, 0928, 0933, 0938, 0943, 0948, 0953, 0958, 1003, 1008, 1013, 1018, 1023, 1029, 1035, 1041, 1047, 1053, 1059, 1105, 1111, 1117, 1123, 1129, 1135, 1141, 1147, 1153, 1159, 1205, 1211, 1217, 1223, 1229, 1235, 1241, 1247, 1253, 1259, 1305, 1311, 1317, 1323, 1329, 1335, 1341, 1347, 1353, 1359, 1405, 1411, 1417, 1423, 1429, 1435, 1441, 1447, 1453, 1459, 1505, 1511, 1517, 1523, 1529, 1535, 1541, 1547, 1553, 1559, 1605, 1611, 1617, 1623, 1629, 1636, 1642, 1648, 1654, 1700, 1706, 1712, 1718, 1724, 1730, 1735, 1740, 1745, 1750, 1755, 1800, 1805, 1810, 1815, 1820, 1825, 1830, 1835, 1840, 1845, 1850, 1855, 1900, 1905, 1910, 1915, 1920, 1925, 1930, 1936, 1943, 1949, 1956, 2002, 2009, 2015, 2022, 2028, 2035, 2041, 2048, 2055, 2102, 2109, 2117, 2124, 2132, 2140, 2148, 2157, 2205, 2214, 2222, 2230, 2238, 2245, 2253, 2300, 2308, 2315, 2323, 2332, 2340, 2347, 2356, 2407, 2416, 2428
      ]
    }
  },
  "半蔵門線/錦糸町/帰り": {
    from: "錦糸町",
    to: ["清澄白河"],
    line: "半蔵門線",
    departures: {
      weekday: [
        0511, 0528, 0544, 0558, 0613, 0624, 0630, 0637, 0645, 0650, 0656, 0700, 0706, 0711, 0715, 0719, 0722, 0729, 0733, 0739, 0743, 0747, 0750, 0755, 0759, 0803, 0807, 0809, 0812, 0815, 0819, 0821, 0826, 0828, 0831, 0835, 0838, 0840, 0844, 0848, 0851, 0854, 0856, 0900, 0902, 0905, 0910, 0912, 0915, 0917, 0921, 0923, 0926, 0928, 0931, 0934, 0937, 0939, 0942, 0945, 0948, 0950, 0953, 0956, 0959, 1002, 1005, 1007, 1010, 1012, 1015, 1018, 1021, 1024, 1027, 1030, 1033, 1038, 1042, 1047, 1052, 1056, 1100, 1105, 1110, 1114, 1119, 1122, 1127, 1132, 1137, 1142, 1147, 1152, 1157, 1202, 1207, 1212, 1217, 1222, 1227, 1232, 1237, 1242, 1247, 1252, 1257, 1302, 1307, 1312, 1317, 1322, 1327, 1332, 1337, 1342, 1347, 1352, 1357, 1402, 1407, 1412, 1417, 1422, 1427, 1432, 1437, 1442, 1447, 1452, 1457, 1502, 1507, 1512, 1517, 1522, 1527, 1532, 1537, 1542, 1547, 1552, 1557, 1602, 1607, 1612, 1617, 1622, 1627, 1632, 1637, 1641, 1644, 1648, 1651, 1655, 1701, 1706, 1710, 1713, 1717, 1720, 1723, 1727, 1731, 1734, 1738, 1741, 1745, 1748, 1752, 1755, 1758, 1801, 1805, 1809, 1812, 1815, 1818, 1821, 1824, 1827, 1830, 1833, 1836, 1839, 1842, 1845, 1848, 1851, 1854, 1858, 1901, 1904, 1908, 1911, 1914, 1918, 1921, 1924, 1928, 1931, 1934, 1938, 1941, 1944, 1948, 1951, 1954, 1958, 2001, 2004, 2008, 2011, 2014, 2018, 2021, 2025, 2028, 2032, 2035, 2039, 2043, 2046, 2050, 2055, 2058, 2101, 2106, 2109, 2112, 2115, 2118, 2122, 2125, 2129, 2132, 2137, 2140, 2143, 2147, 2150, 2154, 2158, 2201, 2205, 2208, 2212, 2215, 2219, 2222, 2227, 2232, 2238, 2242, 2247, 2252, 2257, 2302, 2307, 2311, 2321, 2326, 2331, 2335, 2340, 2346, 2349, 2358, 2409, 2418, 2429, 2436
      ]
    }
  },
  "東西線/門前仲町/帰り": {
    from: "門前仲町",
    to: ["葛西"],
    line: "東西線",
    departures: {
      weekday: [
        0526, 0538, 0548, 0558, 0608, 0619, 0625, 0637, 0644, 0658, 0705, 0715, 0719, 0726, 0730, 0733, 0738, 0741, 0744, 0751, 0754, 0800, 0803, 0808, 0811, 0817, 0820, 0826, 0828, 0831, 0836, 0838, 0841, 0846, 0848, 0851, 0855, 0858, 0901, 0906, 0908, 0910, 0916, 0918, 0920, 0926, 0928, 0931, 0934, 0941, 0944, 0950, 0952, 0954, 0958, 1001, 1004, 1006, 1011, 1013, 1016, 1022, 1025, 1027, 1032, 1035, 1038, 1040, 1046, 1051, 1054, 1103, 1107, 1115, 1120, 1130, 1135, 1145, 1150, 1200, 1205, 1215, 1220, 1230, 1235, 1245, 1250, 1300, 1305, 1315, 1320, 1330, 1335, 1345, 1350, 1400, 1405, 1415, 1420, 1430, 1435, 1445, 1450, 1500, 1505, 1515, 1520, 1530, 1535, 1545, 1550, 1600, 1605, 1615, 1620, 1630, 1636, 1646, 1651, 1655, 1703, 1707, 1710, 1717, 1722, 1725, 1732, 1736, 1743, 1746, 1752, 1756, 1803, 1807, 1813, 1815, 1817, 1822, 1826, 1831, 1835, 1840, 1844, 1852, 1855, 1901, 1904, 1911, 1917, 1920, 1923, 1930, 1933, 1938, 1941, 1944, 1952, 1956, 2003, 2006, 2010, 2017, 2021, 2025, 2032, 2036, 2042, 2046, 2054, 2057, 2106, 2111, 2118, 2124, 2132, 2136, 2144, 2147, 2155, 2158, 2207, 2210, 2218, 2222, 2231, 2235, 2243, 2247, 2252, 2300, 2305, 2310, 2320, 2325, 2330, 2339, 2344, 2347, 2353, 2400, 2404, 2407, 2412, 2417, 2421, 2427
      ]
    }
  },
  "三田線/御成門/行き": {
    from: "御成門",
    to: ["白金高輪", "目黒"],
    line: "三田線",
    departures: {
      weekday: [
        0513, 0523, 0537, 0551, 0602, 0613, 0622, 0628, 0633, 0641, 0648, 0655, 0701, 0706, 0712, 0716, 0721, 0726, 0730, 0736, 0740, 0745, 0748, 0751, 0756, 0759, 0802, 0805, 0808, 0811, 0814, 0817, 0820, 0824, 0827, 0830, 0833, 0836, 0840, 0843, 0846, 0849, 0851, 0854, 0858, 0902, 0906, 0910, 0914, 0917, 0922, 0927, 0932, 0937, 0942, 0944, 0949, 0953, 0958, 1004, 1010, 1016, 1022, 1028, 1033, 1040, 1046, 1052, 1058, 1104, 1110, 1116, 1122, 1128, 1134, 1140, 1146, 1152, 1158, 1204, 1210, 1217, 1223, 1229, 1235, 1241, 1247, 1253, 1259, 1305, 1311, 1317, 1323, 1329, 1335, 1341, 1347, 1353, 1359, 1405, 1411, 1417, 1423, 1429, 1435, 1441, 1447, 1453, 1459, 1505, 1511, 1517, 1523, 1529, 1535, 1541, 1547, 1553, 1559, 1605, 1611, 1617, 1623, 1629, 1635, 1641, 1647, 1653, 1659, 1705, 1711, 1717, 1721, 1727, 1732, 1738, 1743, 1748, 1752, 1757, 1802, 1808, 1812, 1817, 1823, 1827, 1832, 1837, 1842, 1848, 1852, 1857, 1902, 1907, 1912, 1917, 1924, 1928, 1933, 1938, 1944, 1950, 1957, 2002, 2009, 2014, 2020, 2026, 2032, 2038, 2044, 2051, 2057, 2103, 2109, 2114, 2122, 2128, 2134, 2139, 2146, 2154, 2201, 2208, 2215, 2222, 2229, 2236, 2243, 2252, 2301, 2309, 2318, 2326, 2336, 2348, 2402, 2417, 2430
      ]
    }
  },
  "三田線/御成門/帰り": {
    from: "御成門",
    to: ["大手町"],
    line: "三田線",
    departures: {
      weekday: [
        0506, 0523, 0537, 0550, 0603, 0614, 0624, 0633, 0644, 0654, 0703, 0708, 0716, 0725, 0731, 0737, 0742, 0747, 0753, 0759, 0804, 0808, 0812, 0816, 0820, 0824, 0827, 0831, 0833, 0836, 0838, 0841, 0844, 0846, 0849, 0852, 0856, 0859, 0902, 0905, 0909, 0913, 0916, 0919, 0922, 0926, 0930, 0934, 0938, 0942, 0946, 0950, 0954, 0957, 1001, 1005, 1009, 1013, 1017, 1021, 1026, 1032, 1038, 1043, 1048, 1054, 1100, 1106, 1112, 1118, 1124, 1130, 1136, 1142, 1148, 1154, 1200, 1206, 1212, 1218, 1224, 1230, 1236, 1242, 1248, 1254, 1300, 1306, 1312, 1318, 1324, 1330, 1336, 1342, 1348, 1354, 1400, 1406, 1412, 1418, 1424, 1430, 1436, 1442, 1448, 1454, 1500, 1506, 1512, 1518, 1524, 1530, 1536, 1542, 1548, 1554, 1600, 1606, 1612, 1618, 1624, 1630, 1636, 1642, 1649, 1655, 1701, 1707, 1714, 1720, 1726, 1732, 1737, 1743, 1747, 1753, 1758, 1803, 1808, 1813, 1818, 1823, 1828, 1833, 1838, 1843, 1848, 1853, 1858, 1903, 1908, 1913, 1918, 1923, 1929, 1934, 1939, 1944, 1949, 1955, 2000, 2005, 2011, 2016, 2022, 2028, 2034, 2039, 2046, 2053, 2100, 2106, 2113, 2121, 2127, 2134, 2141, 2148, 2155, 2201, 2207, 2214, 2221, 2228, 2235, 2242, 2250, 2257, 2305, 2313, 2321, 2329, 2337, 2344, 2351, 2358, 2406, 2413
      ]
    }
  },
  "半蔵門線/永田町/帰り": {
    from: "永田町",
    to: ["九段下"],
    line: "半蔵門線",
    departures: {
      /*weekday: [
        0522, 0536, 0551, 0602, 0608, 0614, 0623, 0628, 0634, 0638, 0641, 0644, 0649, 0653, 0657, 0700, 0704, 0707, 0711, 0714, 0716, 0719, 0721, 0724, 0726, 0729, 0731, 0734, 0736, 0739, 0741, 0744, 0746, 0749, 0751, 0754, 0756, 0758, 0801, 0803, 0805, 0807, 0810, 0812, 0814, 0816, 0819, 0821, 0823, 0826, 0828, 0830, 0833, 0835, 0837, 0840, 0842, 0844, 0847, 0849, 0851, 0854, 0856, 0858, 0901, 0903, 0905, 0907, 0910, 0912, 0914, 0916, 0919, 0921, 0924, 0927, 0930, 0933, 0935, 0939, 0941, 0945, 0948, 0951, 0954, 0958, 1001, 1004, 1007, 1010, 1012, 1015, 1020, 1025, 1030, 1033, 1038, 1043, 1048, 1052, 1056, 1100, 1105, 1110, 1115, 1120, 1124, 1130, 1135, 1140, 1145, 1150, 1155, 1200, 1205, 1210, 1215, 1220, 1225, 1230, 1235, 1240, 1245, 1250, 1255, 1300, 1305, 1310, 1315, 1320, 1325, 1330, 1335, 1340, 1345, 1350, 1355, 1400, 1405, 1410, 1415, 1420, 1425, 1430, 1435, 1440, 1445, 1450, 1455, 1500, 1505, 1510, 1515, 1520, 1525, 1530, 1535, 1540, 1545, 1550, 1555, 1600, 1605, 1610, 1615, 1619, 1622, 1626, 1629, 1633, 1638, 1643, 1648, 1651, 1655, 1658, 1701, 1705, 1708, 1711, 1715, 1719, 1722, 1726, 1729, 1732, 1735, 1739, 1742, 1746, 1749, 1752, 1755, 1758, 1801, 1804, 1807, 1810, 1813, 1816, 1819, 1822, 1825, 1829, 1832, 1835, 1838, 1841, 1845, 1849, 1852, 1855, 1859, 1902, 1905, 1909, 1912, 1915, 1918, 1921, 1925, 1929, 1932, 1935, 1938, 1941, 1945, 1949, 1952, 1955, 1959, 2002, 2006, 2009, 2013, 2016, 2020, 2023, 2027, 2031, 2035, 2038, 2042, 2045, 2049, 2052, 2056, 2059, 2103, 2106, 2110, 2113, 2117, 2121, 2124, 2128, 2132, 2135, 2139, 2142, 2146, 2149, 2153, 2156, 2200, 2205, 2210, 2215, 2220, 2225, 2230, 2235, 2240, 2245, 2249, 2254, 2259, 2304, 2309, 2313, 2318, 2323, 2327, 2336, 2346, 2356, 2407, 2414, 2422
      ],*/
      holiday: [
        0522, 0536, 0551, 0608, 0618, 0625, 0635, 0641, 0648, 0653, 0659, 0706, 0712, 0717, 0722, 0727, 0732, 0737, 0742, 0746, 0751, 0755, 0800, 0804, 0809, 0814, 0818, 0823, 0828, 0833, 0837, 0842, 0846, 0851, 0855, 0900, 0904, 0909, 0913, 0917, 0922, 0926, 0930, 0934, 0938, 0942, 0947, 0950, 0956, 0959, 1004, 1009, 1015, 1019, 1024, 1029, 1035, 1039, 1045, 1050, 1055, 1100, 1105, 1110, 1115, 1120, 1125, 1130, 1135, 1140, 1145, 1150, 1155, 1200, 1205, 1210, 1215, 1220, 1225, 1230, 1235, 1240, 1245, 1250, 1255, 1300, 1305, 1310, 1315, 1320, 1325, 1330, 1335, 1340, 1345, 1350, 1355, 1400, 1405, 1410, 1415, 1420, 1425, 1430, 1435, 1440, 1445, 1450, 1455, 1500, 1505, 1510, 1515, 1520, 1525, 1530, 1535, 1540, 1545, 1550, 1555, 1600, 1605, 1610, 1615, 1620, 1625, 1630, 1635, 1640, 1645, 1650, 1655, 1700, 1705, 1710, 1715, 1720, 1725, 1730, 1735, 1740, 1745, 1750, 1755, 1800, 1805, 1810, 1815, 1820, 1825, 1830, 1835, 1840, 1845, 1850, 1855, 1900, 1905, 1910, 1915, 1920, 1925, 1930, 1935, 1940, 1945, 1950, 1955, 2000, 2005, 2010, 2015, 2020, 2025, 2030, 2035, 2040, 2046, 2052, 2057, 2103, 2109, 2115, 2120, 2126, 2133, 2139, 2145, 2150, 2156, 2202, 2209, 2214, 2220, 2228, 2235, 2242, 2250, 2257, 2305, 2311, 2318, 2326, 2333, 2347, 2400
      ]
    }
  },
  "南北線/永田町/帰り": {
    from: "永田町",
    to: ["飯田橋"],
    line: "南北線",
    departures: {
      /*weekday: [
        0515, 0530, 0542, 0553, 0603, 0615, 0624, 0635, 0643, 0653, 0703, 0712, 0722, 0731, 0737, 0743, 0748, 0753, 0759, 0805, 0809, 0813, 0816, 0821, 0825, 0829, 0833, 0837, 0841, 0844, 0849, 0853, 0857, 0900, 0903, 0907, 0910, 0913, 0917, 0921, 0925, 0929, 0933, 0938, 0943, 0949, 0955, 1002, 1007, 1013, 1019, 1025, 1029, 1035, 1041, 1047, 1053, 1059, 1105, 1111, 1117, 1123, 1129, 1135, 1141, 1147, 1153, 1159, 1205, 1211, 1217, 1223, 1229, 1235, 1241, 1247, 1253, 1259, 1305, 1311, 1317, 1323, 1329, 1335, 1341, 1347, 1353, 1359, 1405, 1411, 1417, 1423, 1429, 1435, 1441, 1447, 1453, 1459, 1505, 1511, 1517, 1523, 1529, 1535, 1541, 1547, 1553, 1559, 1605, 1611, 1617, 1623, 1629, 1635, 1641, 1647, 1653, 1659, 1706, 1712, 1718, 1724, 1730, 1736, 1741, 1747, 1752, 1757, 1803, 1807, 1812, 1817, 1823, 1827, 1832, 1837, 1842, 1847, 1852, 1857, 1903, 1908, 1912, 1918, 1923, 1928, 1933, 1938, 1943, 1948, 1954, 2000, 2007, 2013, 2019, 2026, 2031, 2037, 2043, 2050, 2058, 2104, 2109, 2116, 2123, 2131, 2138, 2143, 2150, 2158, 2204, 2211, 2217, 2224, 2232, 2239, 2245, 2252, 2259, 2307, 2316, 2323, 2330, 2337, 2344, 2352, 2402, 2408, 2415
      ],*/
      holiday: [
        0515, 0530, 0542, 0553, 0603, 0613, 0623, 0633, 0643, 0653, 0702, 0713, 0722, 0729, 0736, 0742, 0748, 0754, 0800, 0806, 0812, 0817, 0823, 0828, 0833, 0838, 0843, 0848, 0853, 0858, 0903, 0908, 0913, 0918, 0923, 0927, 0931, 0936, 0941, 0947, 0953, 0959, 1005, 1011, 1017, 1023, 1029, 1035, 1041, 1047, 1053, 1059, 1105, 1111, 1117, 1123, 1129, 1135, 1141, 1147, 1153, 1159, 1205, 1211, 1217, 1223, 1229, 1235, 1241, 1247, 1253, 1259, 1305, 1311, 1317, 1323, 1329, 1335, 1341, 1347, 1353, 1359, 1405, 1411, 1417, 1423, 1429, 1435, 1441, 1447, 1453, 1459, 1505, 1511, 1517, 1523, 1529, 1535, 1541, 1547, 1553, 1559, 1605, 1611, 1617, 1623, 1629, 1635, 1641, 1647, 1653, 1659, 1705, 1711, 1717, 1723, 1729, 1735, 1741, 1747, 1753, 1759, 1805, 1811, 1817, 1823, 1829, 1835, 1841, 1847, 1853, 1859, 1905, 1911, 1917, 1924, 1931, 1938, 1944, 1951, 1957, 2004, 2011, 2018, 2026, 2033, 2040, 2047, 2055, 2102, 2111, 2119, 2126, 2133, 2141, 2148, 2155, 2203, 2211, 2218, 2227, 2234, 2241, 2249, 2256, 2303, 2312, 2321, 2330, 2339, 2346, 2354, 2403, 2415
      ]
    }
  },
  "東西線/九段下/帰り": {
    from: "九段下",
    to: ["大手町", "日本橋", "茅場町", "門前仲町", "葛西"],
    line: "東西線",
    departures: {
      weekday: [
        0516, 0528, 0538, 0548, 0558, 0609, 0615, 0627, 0634, 0648, 0655, 0705, 0709, 0716, 0720, 0723, 0728, 0731, 0734, 0740, 0743, 0749, 0752, 0757, 0800, 0805, 0808, 0814, 0816, 0819, 0824, 0826, 0829, 0834, 0836, 0839, 0844, 0846, 0849, 0854, 0856, 0859, 0904, 0906, 0909, 0914, 0917, 0920, 0923, 0930, 0933, 0938, 0941, 0944, 0948, 0951, 0953, 0956, 1001, 1003, 1006, 1012, 1015, 1017, 1022, 1025, 1028, 1030, 1036, 1041, 1044, 1053, 1057, 1105, 1110, 1120, 1125, 1135, 1140, 1150, 1155, 1205, 1210, 1220, 1225, 1235, 1240, 1250, 1255, 1305, 1310, 1320, 1325, 1335, 1340, 1350, 1355, 1405, 1410, 1420, 1425, 1435, 1440, 1450, 1455, 1505, 1510, 1520, 1525, 1535, 1540, 1550, 1555, 1605, 1610, 1620, 1625, 1635, 1640, 1644, 1653, 1656, 1700, 1707, 1711, 1715, 1722, 1726, 1732, 1736, 1742, 1746, 1752, 1756, 1802, 1804, 1807, 1812, 1815, 1821, 1824, 1830, 1833, 1841, 1844, 1851, 1854, 1900, 1906, 1909, 1912, 1920, 1922, 1928, 1931, 1934, 1941, 1945, 1952, 1956, 1959, 2006, 2011, 2015, 2022, 2025, 2032, 2036, 2043, 2047, 2056, 2100, 2108, 2113, 2121, 2125, 2133, 2136, 2145, 2148, 2156, 2200, 2207, 2211, 2221, 2225, 2233, 2237, 2241, 2250, 2255, 2300, 2309, 2314, 2319, 2329, 2333, 2337, 2342, 2350, 2354, 2357, 2402, 2407, 2411, 2417
      ],
      holiday: [
        0516, 0528, 0539, 0549, 0559, 0609, 0615, 0622, 0631, 0638, 0647, 0655, 0704, 0710, 0717, 0724, 0730, 0737, 0743, 0748, 0755, 0801, 0807, 0813, 0819, 0825, 0828, 0832, 0837, 0842, 0846, 0851, 0900, 0904, 0908, 0917, 0921, 0926, 0936, 0940, 0950, 0955, 1005, 1010, 1020, 1025, 1035, 1040, 1050, 1055, 1105, 1110, 1120, 1125, 1135, 1140, 1150, 1155, 1205, 1210, 1220, 1225, 1235, 1240, 1250, 1255, 1305, 1310, 1320, 1325, 1335, 1340, 1350, 1355, 1405, 1410, 1420, 1425, 1435, 1440, 1450, 1455, 1505, 1510, 1520, 1525, 1535, 1540, 1550, 1555, 1605, 1610, 1620, 1625, 1636, 1641, 1651, 1656, 1706, 1711, 1721, 1726, 1736, 1741, 1751, 1756, 1806, 1811, 1821, 1826, 1836, 1841, 1851, 1856, 1906, 1911, 1921, 1926, 1931, 1941, 1946, 1952, 2003, 2008, 2014, 2025, 2031, 2037, 2043, 2054, 2100, 2106, 2112, 2123, 2129, 2135, 2141, 2152, 2159, 2205, 2212, 2220, 2227, 2235, 2242, 2250, 2258, 2306, 2313, 2320, 2328, 2335, 2344, 2352, 2357, 2407, 2417
      ]
    }
  },
  "半蔵門線/九段下/行き": {
    from: "九段下",
    to: ["永田町"],
    line: "半蔵門線",
    departures: {
      /*weekday: [
        0511, 0525, 0540, 0554, 0605, 0612, 0621, 0628, 0635, 0643, 0650, 0656, 0703, 0707, 0712, 0716, 0720, 0724, 0728, 0732, 0736, 0739, 0745, 0748, 0752, 0755, 0758, 0801, 0804, 0807, 0810, 0812, 0816, 0819, 0822, 0825, 0827, 0830, 0832, 0835, 0837, 0840, 0842, 0844, 0846, 0849, 0851, 0853, 0857, 0900, 0902, 0906, 0909, 0911, 0916, 0919, 0921, 0925, 0928, 0930, 0935, 0938, 0943, 0945, 0948, 0953, 0956, 0958, 1001, 1007, 1010, 1012, 1015, 1018, 1020, 1026, 1029, 1031, 1035, 1038, 1041, 1043, 1046, 1049, 1053, 1057, 1102, 1108, 1113, 1118, 1123, 1127, 1131, 1135, 1139, 1143, 1150, 1153, 1158, 1203, 1208, 1213, 1220, 1223, 1228, 1233, 1238, 1243, 1250, 1253, 1258, 1303, 1308, 1313, 1320, 1323, 1328, 1333, 1338, 1343, 1350, 1353, 1358, 1403, 1408, 1413, 1420, 1423, 1429, 1433, 1438, 1443, 1450, 1453, 1458, 1503, 1508, 1513, 1520, 1523, 1529, 1533, 1538, 1543, 1550, 1553, 1558, 1603, 1608, 1613, 1620, 1623, 1629, 1633, 1638, 1643, 1649, 1653, 1658, 1703, 1708, 1712, 1716, 1720, 1724, 1728, 1732, 1736, 1739, 1743, 1746, 1750, 1753, 1756, 1759, 1802, 1805, 1809, 1812, 1815, 1818, 1821, 1824, 1827, 1831, 1834, 1837, 1840, 1843, 1846, 1849, 1852, 1855, 1858, 1901, 1904, 1907, 1910, 1913, 1916, 1919, 1923, 1926, 1930, 1933, 1936, 1940, 1943, 1946, 1950, 1953, 1956, 2000, 2003, 2006, 2010, 2013, 2016, 2020, 2023, 2026, 2030, 2033, 2036, 2040, 2043, 2046, 2050, 2053, 2057, 2101, 2105, 2109, 2112, 2115, 2119, 2122, 2126, 2129, 2133, 2136, 2140, 2143, 2147, 2150, 2154, 2157, 2201, 2204, 2208, 2211, 2215, 2218, 2222, 2225, 2229, 2232, 2236, 2240, 2244, 2249, 2253, 2257, 2301, 2305, 2309, 2314, 2319, 2326, 2332, 2338, 2345, 2352, 2358, 2402, 2408, 2412, 2419, 24272
      ],*/
      holiday: [
        0511, 0525, 0540, 0554, 0607, 0620, 0628, 0635, 0641, 0653, 0658, 0706, 0713, 0719, 0727, 0733, 0739, 0745, 0750, 0756, 0801, 0807, 0812, 0817, 0822, 0826, 0831, 0835, 0840, 0844, 0849, 0853, 0858, 0902, 0907, 0912, 0917, 0921, 0926, 0930, 0935, 0940, 0944, 0948, 0952, 0957, 1001, 1006, 1010, 1014, 1018, 1023, 1026, 1031, 1036, 1041, 1044, 1050, 1053, 1058, 1103, 1108, 1113, 1120, 1123, 1128, 1133, 1138, 1143, 1150, 1153, 1158, 1203, 1208, 1213, 1220, 1223, 1228, 1233, 1238, 1243, 1250, 1253, 1258, 1303, 1308, 1313, 1320, 1323, 1328, 1333, 1338, 1343, 1350, 1353, 1358, 1403, 1408, 1413, 1420, 1423, 1428, 1433, 1438, 1443, 1450, 1453, 1458, 1503, 1508, 1513, 1520, 1523, 1529, 1533, 1538, 1543, 1550, 1553, 1559, 1603, 1608, 1613, 1620, 1623, 1628, 1633, 1638, 1643, 1650, 1653, 1658, 1703, 1708, 1713, 1718, 1723, 1728, 1733, 1738, 1743, 1748, 1753, 1758, 1803, 1808, 1813, 1818, 1823, 1828, 1833, 1838, 1843, 1848, 1853, 1858, 1903, 1908, 1913, 1918, 1923, 1928, 1933, 1938, 1943, 1948, 1953, 1958, 2003, 2008, 2013, 2018, 2023, 2028, 2033, 2038, 2043, 2048, 2053, 2058, 2103, 2108, 2113, 2119, 2125, 2132, 2138, 2144, 2150, 2156, 2202, 2208, 2214, 2219, 2225, 2232, 2239, 2245, 2252, 2259, 2306, 2313, 2319, 2330, 2343, 2352, 2401, 2407, 2412
      ]
    }
  }
};

function getValues() {
  return Object.keys(nameToDepartures).map(function(key) {
    return nameToDepartures[key];
  });
}

const dateType = getDateType();
const fromList = Object.keys(getValues().filter(function(value) {
  return (dateType in value.departures) || (dateType === 'saturday' && 'holiday' in value.departures);
}).map(function(value) {
  return value.from;
}).reduce(function(result, current) {
  result[current] = true;
  return result;
}, {}));

TimeTable.getFromList = function() {
  return fromList;
};

TimeTable.getListByFrom = function(from) {
  return getValues().filter(function(value) {
    return value.from == from;
  });
};

TimeTable.getToListByFrom = function(from) {
  return Object.keys(getValues().filter(function(value) {
    return value.from == from && ((dateType in value.departures) || (dateType === 'saturday') && ('holiday' in value.departures));
  }).map(function(value) {
    return value.to;
  }).reduce(function(result, current) {
    current.forEach(function(c) {
      result[c] = true;
    });
    return result;
  }, {}));
};

function TimeTable(any) {
  if (typeof any === "string") {
    this.name = any;
    this.departures = nameToDepartures[any].departures;
  }
  else {
    this.name = any.line + "/" + any.from;
    this.from = any.from;
    this.line = any.line;
    const dateType = getDateType();
    if (dateType in any.departures) {
      this.departures = any.departures[dateType];
    }
    else if (dateType === 'saturday' && 'holiday' in any.departures) {
      this.departures = any.departures['holiday'];
    }
    else {
      this.departures = [];
    }
    this.updateEstimateExpression();
  }
}

TimeTable.prototype.check = function() {
  const now = new Date();
  const hours = now.getHours();
  const minutes = now.getMinutes();
  this.filteredDepartures = this.departures.filter(function(departure) {
    return hours * 100 + minutes < departure;
  });
  if (this.filteredDepartures.length > 0) {
    const next = this.filteredDepartures[0];
    const nextHour = Math.floor(next / 100);
    const nextMinutes = next % 100;

    this.remain = (new Date(now.getFullYear(), now.getMonth(), now.getDate(), nextHour, nextMinutes, 0).getTime() - now.getTime()) / 1000;
    this.remainExpression = secondToMinuteSecondExpression(this.remain);
    this.filteredDepartures = this.filteredDepartures.map(function(num) {
      return (num + 10000 + "").substr(1);
    });
  }
  else {
    this.filteredDepartures = ["None"];
    this.remainExpression = "";
  }
};

TimeTable.prototype.updateEstimateExpression = function() {
  const self = this;
  const filtered = timeRequiredData.filter(function(data) {
    return data.from == self.from && data.line == self.line;
  }).map(function(data) {
    return data.time;
  });
  this.estimateExpression = secondToMinuteSecondExpression(
    Math.ceil(filtered.reduce(function(a, b) { return a + b; }, 0) / (filtered.length || 1))
  );
};

TimeTable.prototype.recordStart = function() {
  this.recordStartTime = new Date().getTime();
};

TimeTable.prototype.recordEnd = function() {
  const self = this;
  const date = new Date().getTime();
  const time = Math.ceil((date - this.recordStartTime) / 1000);
  const record = { from: this.from, line: this.line, time, date };
  getOrInsertTimeRequiredData(record, function() {
    self.updateEstimateExpression();
  });
};

TimeTable.getHistory = function(from, line) {
  return timeRequiredData.filter(function(data) {
    return data.from == from && data.line == line;
  });
};

module.exports = TimeTable;
